[merge.py] dist_mode=ddp, is_distributed=True, world_size=4, device=cuda:0
[merge.py] Using subset_fraction=0.05 â†’ keeping 384/7693 tickers
Prices:   (1692942, 11)
News:     (367845, 3)
Indexes:  (14280, 4)
[merge.py] Total headlines: 367845, world_size=4, per_rankâ‰ˆ91962
[Rank 0] headlines shard: 91962 rows (start=0, end=91962)
[Rank 1] headlines shard: 91962 rows (start=91962, end=183924)
[Rank 3] headlines shard: 91959 rows (start=275886, end=367845)
[FinBERT] Loading fine-tuned weights from models/run3.safetensors ...
[FinBERT] Loading fine-tuned weights from models/run3.safetensors ...
[FinBERT] Loading fine-tuned weights from models/run3.safetensors ...
[Rank 1] Encoded 256/91962 headlines...[Rank 0] Encoded 256/91962 headlines...

[Rank 3] Encoded 256/91959 headlines...
[Rank 2] headlines shard: 91962 rows (start=183924, end=275886)
[Rank 1] Encoded 13056/91962 headlines...
[FinBERT] Loading fine-tuned weights from models/run3.safetensors ...
[Rank 0] Encoded 13056/91962 headlines...
[Rank 2] Encoded 256/91962 headlines...
[Rank 3] Encoded 13056/91959 headlines...
[Rank 1] Encoded 25856/91962 headlines...
[Rank 0] Encoded 25856/91962 headlines...
[Rank 3] Encoded 25856/91959 headlines...
[Rank 2] Encoded 13056/91962 headlines...
[Rank 1] Encoded 38656/91962 headlines...
[Rank 3] Encoded 38656/91959 headlines...
[Rank 0] Encoded 38656/91962 headlines...
[Rank 2] Encoded 25856/91962 headlines...
[Rank 3] Encoded 51456/91959 headlines...
[Rank 1] Encoded 51456/91962 headlines...
[Rank 0] Encoded 51456/91962 headlines...
[Rank 2] Encoded 38656/91962 headlines...
[Rank 3] Encoded 64256/91959 headlines...
[Rank 1] Encoded 64256/91962 headlines...
[Rank 0] Encoded 64256/91962 headlines...
[Rank 3] Encoded 77056/91959 headlines...
[Rank 2] Encoded 51456/91962 headlines...
[Rank 1] Encoded 77056/91962 headlines...
[Rank 0] Encoded 77056/91962 headlines...
[Rank 3] Encoded 89856/91959 headlines...
[Rank 1] Encoded 89856/91962 headlines...
[Rank 2] Encoded 64256/91962 headlines...
[Rank 0] Encoded 89856/91962 headlines...
[Rank 2] Encoded 77056/91962 headlines...
[Rank 2] Encoded 89856/91962 headlines...
[merge.py] Global daily_news shape after gather: (161320, 773)
[merge.py] Dropped 384 rows with NaN target_ret1 (last days per ticker).
[merge.py] Saved merged dataset to data/data/merged_lstm_dataset_nickel.parquet with shape (1692558, 785)

[merge.py] Benchmark (seconds):
  load_data        = 82.210
  finbert_init     = 2.627
  embed_local_rank0= 15.047
  embed_global_max = 17.243
  merge+save       = 65.973
  total            = 175.332
